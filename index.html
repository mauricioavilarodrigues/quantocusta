<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>QUANTOCU$TA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous"/>
  <link rel="stylesheet" href="style.css?v=3" />
</head>

<body>
  <!-- TOPO / BARRA INICIAL -->
  <header>
    <nav>
      <a href="index.html">InÃ­cio</a>
      <a href="quem-somos.html">Quem somos</a>
      <a href="parceiro.html">Seja parceiro</a>
      <a href="contato.html">Fale conosco</a>
    </nav>

    <h1 class="titulo">
      <a class="slogan-botao" href="index.html">Masquantocusta ğŸ’°</a>
    </h1>

    <div class="auth-buttons">
      <a href="login.html"><button id="btnAbrirLogin" type="button">Entrar</button></a>
      <a id="btnCadastrar" href="cadastro.html" class="register-btn">Cadastre-se gratuitamente</a>
    </div>

    <!-- Ãrea do usuÃ¡rio logado -->
    <div id="areaUsuario" style="display:none;">
      <span id="nomeUsuario"></span>
      <button id="btnLogout" type="button">Sair</button>
    </div>
  </header>

  <!-- NICHOS -->
  <div class="topo">
    <button type="button" onclick="setNicho('supermercado',this)">ğŸ›’ Supermercado</button>
    <button type="button" onclick="setNicho('combustivel',this)">â›½ CombustÃ­vel</button>
    <button type="button" onclick="setNicho('farmacia',this)">ğŸ’Š FarmÃ¡cia</button>
  </div>

  <div id="filtroSupermercado" class="filtros" style="display:none;">
    <button type="button" onclick="setCategoria('alimento',this)">ğŸ¥¦ Alimentos</button>
    <button type="button" onclick="setCategoria('limpeza',this)">ğŸ§¼ Limpeza</button>
  </div>

  <div id="filtroCombustivel" class="filtros" style="display:none;">
    <button type="button" onclick="setTipo('Comum',this)">Comum</button>
    <button type="button" onclick="setTipo('Aditivada',this)">Aditivada</button>
  </div>

  <div id="filtroFarmacia" class="filtros" style="display:none;">
    <button type="button" onclick="setCategoriaFarmacia('remedio',this)">ğŸ’Š RemÃ©dios</button>
    <button type="button" onclick="setCategoriaFarmacia('higiene',this)">ğŸ§´ Higiene</button>
  </div>

  <!-- BUSCA -->
  <form onsubmit="buscar(); return false;">
    <div style="max-width:900px;margin:12px auto;display:flex;justify-content:center;gap:10px;flex-wrap:wrap;">
      <input id="busca" placeholder="Buscar..." />
      <button type="submit">Buscar</button>
    </div>
  </form>

  <div class="busca">
    <ul id="resultado"></ul>
  </div>

  <div class="caixa">
    <button type="button" onclick="compararCesta()">ğŸ§º Comparar cesta</button>
    <div id="cestaResultado"></div>
  </div>

  <div class="caixa">
    <button type="button" onclick="acharMelhorOpcao()">ğŸ“ Melhor opÃ§Ã£o perto de vocÃª</button>
  </div>

  <div class="caixa">
    <h3>Mapa de LocalizaÃ§Ã£o</h3>
    <div id="map" style="height: 420px; width: 100%; border-radius: 12px;"></div>
  </div>

  <!-- CONTRIBUIR -->
  <div class="caixa contribuir-wrap">
    <h3>ğŸ’¬ Viu um preÃ§o diferente?</h3>
    <p style="margin-bottom:14px;">Clique no botÃ£o para abrir o formulÃ¡rio e contribuir.</p>

    <a href="contribuir.html">
      <button
        type="button"
        style="
          background:#4f5dff;
          color:#fff;
          padding:14px 22px;
          border-radius:999px;
          font-weight:700;
          border:none;
          cursor:pointer;
          box-shadow:0 8px 20px rgba(79,93,255,.35);
        "
      >
        â• Contribuir com um preÃ§o
      </button>
    </a>
  </div>

  <!-- NFC-e: Modal + Resultado -->
  <div id="qrModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); z-index:9999;">
    <div style="max-width:520px;margin:6vh auto;background:#fff;border-radius:12px;padding:14px;">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
        <h3 style="margin:0;">Ler QR da NFC-e</h3>
        <button id="btnFecharQr" type="button">âœ–</button>
      </div>

      <p style="margin:10px 0 12px;color:#444;">Aponte a cÃ¢mera para o QR da nota fiscal (NFC-e).</p>

      <div id="qrReader" style="width:100%;"></div>
      <div id="qrStatus" style="margin-top:10px;font-size:.95rem;color:#333;"></div>
    </div>
  </div>

  <div class="caixa" style="max-width:900px;margin:16px auto;">
    <h3>ImportaÃ§Ã£o da NFC-e</h3>

    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-bottom:10px;">
      <button id="btnAbrirQr" type="button">ğŸ“· Ler QR (cÃ¢mera)</button>
      <button id="btnNfceLer" type="button">ğŸ”— Ler URL</button>
      <button id="btnNfceImportar" type="button" disabled>â¬†ï¸ Importar preÃ§os</button>
    </div>

    <input
      id="nfceUrl"
      type="text"
      placeholder="Cole aqui a URL da NFC-e (do QR Code)"
      style="width:100%; padding:10px; margin-bottom:8px;"
    />

    <input
      id="nfceCidade"
      type="text"
      placeholder="Cidade (ex: Rio Grande/RS)"
      style="width:100%; padding:10px; margin-bottom:10px;"
    />

    <div id="nfceStatus" style="margin:8px 0; font-size:.95rem;"></div>
    <div id="nfcePreview" style="margin-top:10px;"></div>

    <hr style="margin:14px 0; border:none; border-top:1px solid #eee;" />

    <div id="nfceResultado">Nenhuma nota importada ainda.</div>
  </div>

  <!-- Lib do scanner (CDN) - precisa vir antes do script.js -->
  <script src="https://unpkg.com/html5-qrcode" crossorigin="anonymous"></script>

  <!-- Leaflet (carrega antes do seu script) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>

  <!-- Seu JS -->
  <script src="script.js?v=2"></script>
</body>
</html>
