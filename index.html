<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>quantocusta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f6f7fb;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #333;
    }

    .topo {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    button {
      border: none;
      padding: 10px 16px;
      border-radius: 20px;
      background: #e0e3ff;
      cursor: pointer;
      font-weight: bold;
      transition: .2s;
    }

    button:hover {
      background: #c9ceff;
    }

    button.ativo {
      background: #4f5dff;
      color: white;
    }

    .filtros {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .busca {
      display: flex;
      justify-content: center;
      gap: 6px;
      margin-bottom: 15px;
    }

    input {
      padding: 10px;
      border-radius: 20px;
      border: 1px solid #ccc;
      width: 220px;
    }

    ul {
      list-style: none;
      padding: 0;
      max-width: 500px;
      margin: auto;
    }

    li {
      background: white;
      margin-bottom: 10px;
      padding: 12px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,.08);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .preco {
      font-weight: bold;
      color: #4f5dff;
    }

    .menor {
      border: 2px solid #4f5dff;
    }
  </style>
</head>

<body>

<h1>ðŸ’° quantocusta</h1>

<div class="topo">
  <button onclick="setNicho('supermercado',this)">ðŸ›’ Supermercado</button>
  <button onclick="setNicho('combustivel',this)">â›½ CombustÃ­vel</button>
  <button onclick="setNicho('farmacia',this)">ðŸ’Š FarmÃ¡cia</button>
</div>

<div id="filtroSupermercado" class="filtros" style="display:none;">
  <button onclick="setCategoria('alimento',this)">ðŸ¥¦ Alimentos</button>
  <button onclick="setCategoria('limpeza',this)">ðŸ§¼ Limpeza</button>
</div>

<div id="filtroCombustivel" class="filtros" style="display:none;">
  <button onclick="setTipo('Comum',this)">Comum</button>
  <button onclick="setTipo('Aditivada',this)">Aditivada</button>
</div>

<div id="filtroFarmacia" class="filtros" style="display:none;">
  <button onclick="setCategoriaFarmacia('remedio',this)">ðŸ’Š RemÃ©dios</button>
  <button onclick="setCategoriaFarmacia('higiene',this)">ðŸ§´ Higiene</button>
</div>

<div class="busca">
  <input id="busca" placeholder="Buscar...">
  <button onclick="buscar()">Buscar</button>
</div>

<ul id="resultado"></ul>

<script>
let nichoAtual="", tipoAtual="", categoriaAtual="", categoriaFarmaciaAtual="";

function limparAtivos(grupo){
  document.querySelectorAll(grupo+" button").forEach(b=>b.classList.remove("ativo"));
}

function setNicho(nicho,btn){
  nichoAtual=nicho;
  tipoAtual=""; categoriaAtual=""; categoriaFarmaciaAtual="";
  document.getElementById("resultado").innerHTML="";

  limparAtivos(".topo");
  btn.classList.add("ativo");

  document.getElementById("filtroSupermercado").style.display="none";
  document.getElementById("filtroCombustivel").style.display="none";
  document.getElementById("filtroFarmacia").style.display="none";

  if(nicho==="supermercado") document.getElementById("filtroSupermercado").style.display="flex";
  if(nicho==="combustivel") document.getElementById("filtroCombustivel").style.display="flex";
  if(nicho==="farmacia") document.getElementById("filtroFarmacia").style.display="flex";
}

function setTipo(t,btn){ tipoAtual=t; limparAtivos("#filtroCombustivel"); btn.classList.add("ativo"); buscar(); }
function setCategoria(c,btn){ categoriaAtual=c; limparAtivos("#filtroSupermercado"); btn.classList.add("ativo"); buscar(); }
function setCategoriaFarmacia(c,btn){ categoriaFarmaciaAtual=c; limparAtivos("#filtroFarmacia"); btn.classList.add("ativo"); buscar(); }

async function buscar(){
  if(!nichoAtual) return;
  if(nichoAtual==="combustivel"&&!tipoAtual) return;
  if(nichoAtual==="supermercado"&&!categoriaAtual) return;
  if(nichoAtual==="farmacia"&&!categoriaFarmaciaAtual) return;

  const termo=document.getElementById("busca").value.toLowerCase();
  const res=await fetch("data.json");
  const data=await res.json();

  let itens=data[nichoAtual].filter(p=>p.nome.toLowerCase().includes(termo));

  if(nichoAtual==="combustivel") itens=itens.filter(p=>p.nome.toLowerCase().includes(tipoAtual.toLowerCase()));
  if(nichoAtual==="supermercado") itens=itens.filter(p=>p.tipo===categoriaAtual);
  if(nichoAtual==="farmacia") itens=itens.filter(p=>p.tipo===categoriaFarmaciaAtual);

  itens.sort((a,b)=>a.preco-b.preco);

  const lista=document.getElementById("resultado");
  lista.innerHTML="";

  itens.forEach((p,i)=>{
    const li=document.createElement("li");
    if(i===0) li.classList.add("menor");
    const local=p.loja||p.posto;
    li.innerHTML=`<span>${p.nome}<br><small>${local}</small></span><span class="preco">R$ ${p.preco.toFixed(2)}</span>`;
    lista.appendChild(li);
  });
}
</script>

</body>
</html>
